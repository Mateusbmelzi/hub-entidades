<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Filtro Eventos Aprovados</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; background: #fafafa; }
        .success { color: #388e3c; background: #e8f5e8; padding: 10px; border-radius: 4px; margin: 10px 0; }
        .warning { color: #f57c00; background: #fff3e0; padding: 10px; border-radius: 4px; margin: 10px 0; }
        .info { color: #1976d2; background: #e3f2fd; padding: 10px; border-radius: 4px; margin: 10px 0; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; background: #1976d2; color: white; border: none; border-radius: 4px; }
        button:hover { background: #1565c0; }
        .evento-card { border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin: 10px 0; background: white; }
        .evento-aprovado { border-left: 4px solid #4caf50; }
        .evento-pendente { border-left: 4px solid #ff9800; }
        .evento-rejeitado { border-left: 4px solid #f44336; }
        .status-badge { padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; }
        .status-aprovado { background: #4caf50; color: white; }
        .status-pendente { background: #ff9800; color: white; }
        .status-rejeitado { background: #f44336; color: white; }
        .log { background: #f5f5f5; padding: 10px; border-radius: 4px; margin: 10px 0; font-family: monospace; font-size: 12px; max-height: 300px; overflow-y: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîí Teste do Filtro de Eventos Aprovados</h1>
        <p>Este arquivo testa se apenas eventos aprovados s√£o exibidos para usu√°rios comuns na p√°gina da entidade.</p>
        
        <div class="test-section">
            <h2>üìä Simula√ß√£o de Dados</h2>
            <p>Vamos simular uma entidade com diferentes tipos de eventos para testar o filtro:</p>
            
            <button onclick="simularEventos()">üéØ Simular Eventos da Entidade</button>
            <button onclick="testarFiltroUsuarioComum()">üë§ Testar Filtro (Usu√°rio Comum)</button>
            <button onclick="testarFiltroProprietario()">üëë Testar Filtro (Propriet√°rio)</button>
            <button onclick="limparLog()">üóëÔ∏è Limpar Log</button>
            
            <div id="eventosSimulados"></div>
        </div>
        
        <div class="test-section">
            <h2>üîç Resultado dos Testes</h2>
            <div id="resultadoTestes"></div>
        </div>
        
        <div class="test-section">
            <h2>üìù Log de Debug</h2>
            <div id="log" class="log"></div>
        </div>
    </div>

    <script>
        let eventosSimulados = [];
        let logCount = 0;
        
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${type.toUpperCase()}: ${message}`;
            logDiv.innerHTML += logEntry + '\n';
            logDiv.scrollTop = logDiv.scrollHeight;
            logCount++;
            
            // Limitar log a 100 entradas
            if (logCount > 100) {
                const lines = logDiv.innerHTML.split('\n');
                logDiv.innerHTML = lines.slice(-50).join('\n');
                logCount = 50;
            }
        }
        
        function limparLog() {
            document.getElementById('log').innerHTML = '';
            logCount = 0;
        }
        
        function simularEventos() {
            log('üîÑ Simulando eventos da entidade...');
            
            // Simular eventos com diferentes status de aprova√ß√£o
            eventosSimulados = [
                {
                    id: '1',
                    nome: 'Workshop de React',
                    descricao: 'Workshop pr√°tico sobre React e hooks',
                    data: '2025-02-15',
                    horario: '14:00:00',
                    local: 'Audit√≥rio A',
                    capacidade: 30,
                    status: 'ativo',
                    status_aprovacao: 'aprovado',
                    entidade_id: 1,
                    created_at: '2025-01-10T10:00:00Z'
                },
                {
                    id: '2',
                    nome: 'Palestra sobre IA',
                    descricao: 'Introdu√ß√£o √† Intelig√™ncia Artificial',
                    data: '2025-02-20',
                    horario: '19:00:00',
                    local: 'Sala 302',
                    capacidade: 50,
                    status: 'ativo',
                    status_aprovacao: 'pendente',
                    entidade_id: 1,
                    created_at: '2025-01-12T15:30:00Z'
                },
                {
                    id: '3',
                    nome: 'Hackathon 2025',
                    descricao: 'Competi√ß√£o de programa√ß√£o',
                    data: '2025-03-01',
                    horario: '09:00:00',
                    local: 'Lab de Computa√ß√£o',
                    capacidade: 100,
                    status: 'ativo',
                    status_aprovacao: 'aprovado',
                    entidade_id: 1,
                    created_at: '2025-01-15T08:00:00Z'
                },
                {
                    id: '4',
                    nome: 'Meetup de Startups',
                    descricao: 'Networking com empreendedores',
                    data: '2025-02-25',
                    horario: '18:00:00',
                    local: 'Espa√ßo Coworking',
                    capacidade: 40,
                    status: 'ativo',
                    status_aprovacao: 'rejeitado',
                    entidade_id: 1,
                    created_at: '2025-01-08T12:00:00Z'
                },
                {
                    id: '5',
                    nome: 'Curso de Python',
                    descricao: 'Curso b√°sico de Python para iniciantes',
                    data: '2025-02-28',
                    horario: '16:00:00',
                    local: 'Sala 201',
                    capacidade: 25,
                    status: 'ativo',
                    status_aprovacao: 'aprovado',
                    entidade_id: 1,
                    created_at: '2025-01-20T14:00:00Z'
                }
            ];
            
            const eventosDiv = document.getElementById('eventosSimulados');
            eventosDiv.innerHTML = `
                <div class="success">
                    <h3>‚úÖ Eventos Simulados Criados</h3>
                    <p><strong>Total de eventos:</strong> ${eventosSimulados.length}</p>
                    <div class="info">
                        <strong>Status de aprova√ß√£o:</strong><br>
                        ‚Ä¢ Aprovados: ${eventosSimulados.filter(e => e.status_aprovacao === 'aprovado').length}<br>
                        ‚Ä¢ Pendentes: ${eventosSimulados.filter(e => e.status_aprovacao === 'pendente').length}<br>
                        ‚Ä¢ Rejeitados: ${eventosSimulados.filter(e => e.status_aprovacao === 'rejeitado').length}
                    </div>
                </div>
            `;
            
            // Exibir todos os eventos simulados
            eventosSimulados.forEach(evento => {
                const statusClass = `evento-${evento.status_aprovacao}`;
                const statusBadgeClass = `status-${evento.status_aprovacao}`;
                
                eventosDiv.innerHTML += `
                    <div class="evento-card ${statusClass}">
                        <h4>${evento.nome}</h4>
                        <p><strong>Descri√ß√£o:</strong> ${evento.descricao}</p>
                        <p><strong>Data:</strong> ${evento.data} √†s ${evento.horario}</p>
                        <p><strong>Local:</strong> ${evento.local}</p>
                        <p><strong>Capacidade:</strong> ${evento.capacidade} pessoas</p>
                        <span class="status-badge ${statusBadgeClass}">${evento.status_aprovacao.toUpperCase()}</span>
                    </div>
                `;
            });
            
            log(`‚úÖ ${eventosSimulados.length} eventos simulados criados`);
            log(`üìä Distribui√ß√£o: ${eventosSimulados.filter(e => e.status_aprovacao === 'aprovado').length} aprovados, ${eventosSimulados.filter(e => e.status_aprovacao === 'pendente').length} pendentes, ${eventosSimulados.filter(e => e.status_aprovacao === 'rejeitado').length} rejeitados`);
        }
        
        function testarFiltroUsuarioComum() {
            if (eventosSimulados.length === 0) {
                alert('Primeiro simule os eventos!');
                return;
            }
            
            log('üë§ Testando filtro para usu√°rio comum...');
            
            // Simular o comportamento do hook useEventosEntidade para usu√°rio comum
            const eventosFiltrados = eventosSimulados.filter(evento => 
                evento.status_aprovacao === 'aprovado'
            );
            
            const resultadoDiv = document.getElementById('resultadoTestes');
            resultadoDiv.innerHTML = `
                <div class="success">
                    <h3>‚úÖ Teste Usu√°rio Comum - APROVADO</h3>
                    <p><strong>Eventos vis√≠veis:</strong> ${eventosFiltrados.length} de ${eventosSimulados.length}</p>
                    <p><strong>Filtro aplicado:</strong> status_aprovacao = 'aprovado'</p>
                    <div class="info">
                        <strong>Eventos exibidos:</strong><br>
                        ${eventosFiltrados.map(e => `‚Ä¢ ${e.nome} (${e.data})`).join('<br>')}
                    </div>
                </div>
            `;
            
            log(`‚úÖ Usu√°rio comum v√™ ${eventosFiltrados.length} eventos aprovados`);
            log(`üîí Eventos pendentes e rejeitados foram ocultados`);
        }
        
        function testarFiltroProprietario() {
            if (eventosSimulados.length === 0) {
                alert('Primeiro simule os eventos!');
                return;
            }
            
            log('üëë Testando filtro para propriet√°rio da entidade...');
            
            // Simular o comportamento do hook useEventosEntidade para propriet√°rio
            const eventosFiltrados = eventosSimulados; // Sem filtro para propriet√°rio
            
            const resultadoDiv = document.getElementById('resultadoTestes');
            resultadoDiv.innerHTML = `
                <div class="warning">
                    <h3>üëë Teste Propriet√°rio - TODOS OS EVENTOS</h3>
                    <p><strong>Eventos vis√≠veis:</strong> ${eventosFiltrados.length} de ${eventosSimulados.length}</p>
                    <p><strong>Filtro aplicado:</strong> Nenhum (propriet√°rio v√™ tudo)</p>
                    <div class="info">
                        <strong>Eventos exibidos:</strong><br>
                        ${eventosFiltrados.map(e => `‚Ä¢ ${e.nome} (${e.data}) - ${e.status_aprovacao.toUpperCase()}`).join('<br>')}
                    </div>
                </div>
            `;
            
            log(`üëë Propriet√°rio v√™ todos os ${eventosFiltrados.length} eventos`);
            log(`üìä Incluindo pendentes e rejeitados para gest√£o`);
        }
        
        // Inicializa√ß√£o
        log('üöÄ Sistema de teste inicializado');
        log('üìã Para testar: 1) Simule eventos, 2) Teste filtros');
    </script>
</body>
</html>
